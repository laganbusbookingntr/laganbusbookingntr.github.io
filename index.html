<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Lagan Bus Booking — Modern Booking Portal</title>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<!-- Lottie Animations -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.7.8/lottie.min.js"></script>
<style>
/* ===================== MODERN BLUE THEME WITH ADVANCED FEATURES ===================== */
:root {
  /* Professional Blue Palette */
  --primary-blue: #0EA5E9;
  --secondary-blue: #1D4ED8;
  --accent-blue: #38BDF8;
  --light-blue: #E0F2FE;
  --dark-blue: #0C4A6E;
  --navy-blue: #1E3A8A;
  --gradient-primary: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
  --gradient-glass: linear-gradient(135deg, rgba(14, 165, 233, 0.1) 0%, rgba(29, 78, 216, 0.05) 100%);
  
  /* Modern Design System */
  --glass-bg: rgba(255, 255, 255, 0.9);
  --glass-border: rgba(255, 255, 255, 0.2);
  --shadow-soft: 0 8px 32px rgba(14, 165, 233, 0.08);
  --shadow-medium: 0 12px 48px rgba(14, 165, 233, 0.12);
  --shadow-hard: 0 20px 60px rgba(14, 165, 233, 0.2);
  
  /* Animation Variables */
  --transition-smooth: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-bounce: 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

[data-theme="dark"] {
  --glass-bg: rgba(30, 41, 59, 0.9);
  --glass-border: rgba(255, 255, 255, 0.1);
  --gradient-glass: linear-gradient(135deg, rgba(14, 165, 233, 0.15) 0%, rgba(29, 78, 216, 0.1) 100%);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
  background: linear-gradient(135deg, #F8FAFC 0%, #EFF6FF 100%);
  color: var(--dark-blue);
  min-height: 100vh;
  overflow-x: hidden;
  position: relative;
}

[data-theme="dark"] body {
  background: linear-gradient(135deg, #0F172A 0%, #1E293B 100%);
}

/* ===================== ANIMATED BACKGROUND ELEMENTS ===================== */
.animated-bg {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: -1;
  overflow: hidden;
}

.floating-element {
  position: absolute;
  background: var(--gradient-primary);
  opacity: 0.1;
  border-radius: 50%;
  filter: blur(40px);
  animation: float 20s infinite linear;
}

.floating-element:nth-child(1) {
  width: 400px;
  height: 400px;
  top: 10%;
  left: 5%;
  animation-delay: 0s;
}

.floating-element:nth-child(2) {
  width: 300px;
  height: 300px;
  top: 60%;
  right: 10%;
  animation-delay: -5s;
  background: linear-gradient(135deg, #38BDF8 0%, #0EA5E9 100%);
}

.floating-element:nth-child(3) {
  width: 200px;
  height: 200px;
  bottom: 20%;
  left: 20%;
  animation-delay: -10s;
  background: linear-gradient(135deg, #1D4ED8 0%, #0EA5E9 100%);
}

@keyframes float {
  0%, 100% {
    transform: translate(0, 0) rotate(0deg);
  }
  25% {
    transform: translate(100px, -50px) rotate(90deg);
  }
  50% {
    transform: translate(0, -100px) rotate(180deg);
  }
  75% {
    transform: translate(-100px, -50px) rotate(270deg);
  }
}

/* ===================== MODERN GLASS HEADER ===================== */
.modern-header {
  position: relative;
  padding: 80px 0 60px;
  text-align: center;
  background: linear-gradient(135deg, 
    rgba(14, 165, 233, 0.95) 0%,
    rgba(29, 78, 216, 0.9) 100%);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  margin-bottom: 60px;
  overflow: hidden;
}

.header-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: 0.3;
  background: 
    radial-gradient(circle at 20% 80%, rgba(255, 255, 255, 0.2) 0%, transparent 50%),
    radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.2) 0%, transparent 50%);
}

/* Animated Bus Path */
.bus-path {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 100px;
  background: url("data:image/svg+xml,%3Csvg width='1200' height='100' viewBox='0 0 1200 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0,50 Q300,100 600,50 T1200,50' stroke='rgba(255,255,255,0.2)' fill='none' stroke-width='2' stroke-dasharray='10,5'/%3E%3C/svg%3E");
  background-size: cover;
  animation: movePath 30s linear infinite;
}

@keyframes movePath {
  0% { background-position: 0 0; }
  100% { background-position: 1200px 0; }
}

.header-content {
  position: relative;
  z-index: 2;
}

.animated-logo {
  width: 100px;
  height: 100px;
  margin: 0 auto 30px;
  position: relative;
  animation: logoFloat 6s ease-in-out infinite;
}

.logo-main {
  width: 100%;
  height: 100%;
  background: rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(10px);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 48px;
  color: white;
  border: 3px solid rgba(255, 255, 255, 0.3);
  position: relative;
  overflow: hidden;
}

.logo-main::before {
  content: '';
  position: absolute;
  width: 200%;
  height: 200%;
  background: conic-gradient(from 0deg, transparent, rgba(255, 255, 255, 0.3), transparent 30%);
  animation: rotateLogo 8s linear infinite;
}

@keyframes logoFloat {
  0%, 100% { transform: translateY(0) rotate(0deg); }
  50% { transform: translateY(-15px) rotate(5deg); }
}

@keyframes rotateLogo {
  100% { transform: rotate(360deg); }
}

.brand-title {
  font-size: 3.5rem;
  font-weight: 900;
  margin-bottom: 15px;
  background: linear-gradient(135deg, 
    rgba(255, 255, 255, 1) 0%,
    rgba(224, 242, 254, 1) 50%,
    rgba(255, 255, 255, 1) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
  letter-spacing: -1px;
}

.brand-subtitle {
  font-size: 1.3rem;
  color: rgba(255, 255, 255, 0.95);
  font-weight: 500;
  max-width: 600px;
  margin: 0 auto 40px;
  line-height: 1.6;
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}

.contact-chip {
  display: inline-flex;
  align-items: center;
  gap: 15px;
  background: rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(20px);
  padding: 18px 35px;
  border-radius: 50px;
  color: white;
  font-weight: 600;
  border: 1px solid rgba(255, 255, 255, 0.3);
  transition: all var(--transition-smooth);
  position: relative;
  overflow: hidden;
}

.contact-chip::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  transition: left 0.7s;
}

.contact-chip:hover::before {
  left: 100%;
}

.contact-chip:hover {
  transform: translateY(-3px);
  box-shadow: 0 15px 40px rgba(255, 255, 255, 0.2);
  background: rgba(255, 255, 255, 0.25);
}

/* ===================== INTERACTIVE FEATURES ===================== */
.stats-container {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20px;
  max-width: 1200px;
  margin: -30px auto 40px;
  position: relative;
  z-index: 2;
}

@media (max-width: 768px) {
  .stats-container {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 480px) {
  .stats-container {
    grid-template-columns: 1fr;
  }
}

.stat-card {
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-radius: 20px;
  padding: 25px;
  text-align: center;
  border: 1px solid var(--glass-border);
  box-shadow: var(--shadow-soft);
  transition: all var(--transition-smooth);
  cursor: pointer;
  animation: cardAppear 0.6s ease-out backwards;
}

.stat-card:nth-child(1) { animation-delay: 0.2s; }
.stat-card:nth-child(2) { animation-delay: 0.4s; }
.stat-card:nth-child(3) { animation-delay: 0.6s; }
.stat-card:nth-child(4) { animation-delay: 0.8s; }

@keyframes cardAppear {
  from { 
    opacity: 0; 
    transform: translateY(20px) scale(0.95); 
  }
  to { 
    opacity: 1; 
    transform: translateY(0) scale(1); 
  }
}

.stat-card:hover {
  transform: translateY(-10px) scale(1.02);
  box-shadow: var(--shadow-hard);
  border-color: var(--primary-blue);
}

.stat-icon {
  width: 60px;
  height: 60px;
  background: var(--gradient-primary);
  border-radius: 15px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 15px;
  color: white;
  font-size: 24px;
  transition: all var(--transition-smooth);
  animation: iconBounce 0.5s ease 1s backwards;
}

@keyframes iconBounce {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

.stat-number {
  font-size: 2rem;
  font-weight: 800;
  color: var(--primary-blue);
  margin-bottom: 5px;
  display: block;
  transition: all 0.3s ease;
}

.stat-label {
  font-size: 0.9rem;
  color: var(--dark-blue);
  font-weight: 600;
  opacity: 0.8;
}

[data-theme="dark"] .stat-label {
  color: #E0F2FE;
}

/* ===================== MAIN LAYOUT ===================== */
.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 20px;
}

.main-content {
  display: grid;
  grid-template-columns: 1fr 1.3fr;
  gap: 40px;
  margin-bottom: 60px;
}

@media (max-width: 992px) {
  .main-content {
    grid-template-columns: 1fr;
  }
}

/* ===================== ADVANCED SEARCH CARD ===================== */
.search-card-advanced {
  background: var(--glass-bg);
  backdrop-filter: blur(30px);
  -webkit-backdrop-filter: blur(30px);
  border-radius: 30px;
  padding: 40px;
  border: 1px solid var(--glass-border);
  box-shadow: var(--shadow-medium);
  position: sticky;
  top: 40px;
  transition: all var(--transition-smooth);
}

.search-card-advanced:hover {
  box-shadow: var(--shadow-hard);
  border-color: var(--primary-blue);
}

.card-header-advanced {
  display: flex;
  align-items: center;
  gap: 20px;
  margin-bottom: 40px;
  padding-bottom: 25px;
  border-bottom: 2px solid var(--light-blue);
}

.card-icon-advanced {
  width: 70px;
  height: 70px;
  background: var(--gradient-primary);
  border-radius: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 28px;
  position: relative;
  overflow: hidden;
}

.card-icon-advanced::after {
  content: '';
  position: absolute;
  width: 100%;
  height: 100%;
  background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.3), transparent 70%);
  animation: shine 3s infinite;
}

@keyframes shine {
  0%, 100% { transform: translateX(-100%); }
  50% { transform: translateX(100%); }
}

.card-title-advanced {
  font-size: 2rem;
  font-weight: 800;
  color: var(--dark-blue);
  position: relative;
}

.card-title-advanced::after {
  content: '';
  position: absolute;
  bottom: -10px;
  left: 0;
  width: 60px;
  height: 4px;
  background: var(--gradient-primary);
  border-radius: 2px;
}

[data-theme="dark"] .card-title-advanced {
  color: #F1F5F9;
}

/* Animated Input Field */
.input-group-advanced {
  margin-bottom: 30px;
  position: relative;
}

.input-label-advanced {
  display: block;
  margin-bottom: 12px;
  font-weight: 700;
  color: var(--dark-blue);
  font-size: 1rem;
  display: flex;
  align-items: center;
  gap: 10px;
}

[data-theme="dark"] .input-label-advanced {
  color: #E0F2FE;
}

.input-wrapper-advanced {
  position: relative;
}

.input-field-advanced {
  width: 100%;
  padding: 22px 25px 22px 65px;
  background: var(--glass-bg);
  border: 2px solid var(--glass-border);
  border-radius: 18px;
  color: var(--dark-blue);
  font-size: 1.1rem;
  font-weight: 500;
  transition: all var(--transition-smooth);
  box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.05);
}

[data-theme="dark"] .input-field-advanced {
  color: #F1F5F9;
  background: rgba(30, 41, 59, 0.7);
}

.input-field-advanced:focus {
  outline: none;
  border-color: var(--primary-blue);
  box-shadow: 
    0 0 0 4px rgba(14, 165, 233, 0.1),
    inset 0 2px 10px rgba(14, 165, 233, 0.05);
  transform: translateY(-2px);
}

.input-field-advanced::placeholder {
  color: rgba(12, 74, 110, 0.5);
}

[data-theme="dark"] .input-field-advanced::placeholder {
  color: rgba(203, 213, 225, 0.5);
}

.input-icon-advanced {
  position: absolute;
  left: 25px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--primary-blue);
  font-size: 1.4rem;
  z-index: 2;
}

/* Interactive Button */
.search-btn-advanced {
  width: 100%;
  padding: 24px;
  background: var(--gradient-primary);
  color: white;
  border: none;
  border-radius: 18px;
  font-size: 1.2rem;
  font-weight: 800;
  cursor: pointer;
  transition: all var(--transition-smooth);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 15px;
  margin-top: 10px;
  box-shadow: 
    0 10px 30px rgba(14, 165, 233, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
  position: relative;
  overflow: hidden;
}

.search-btn-advanced::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
  transition: left 0.7s;
}

.search-btn-advanced:hover::before {
  left: 100%;
}

.search-btn-advanced:hover {
  transform: translateY(-5px) scale(1.02);
  box-shadow: 
    0 15px 40px rgba(14, 165, 233, 0.4),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
}

.search-btn-advanced:active {
  transform: translateY(-2px) scale(1);
}

/* ===================== BOOKING STEPS ===================== */
.booking-steps {
  margin-top: 40px;
  padding: 30px;
  background: var(--gradient-glass);
  border-radius: 20px;
  border: 1px solid var(--glass-border);
}

.steps-title {
  font-size: 1.4rem;
  font-weight: 800;
  color: var(--dark-blue);
  margin-bottom: 25px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 15px;
}

[data-theme="dark"] .steps-title {
  color: #F1F5F9;
}

.steps-title i {
  color: var(--primary-blue);
  font-size: 1.6rem;
}

.steps-container {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.step-item {
  display: flex;
  gap: 20px;
  align-items: flex-start;
  padding: 20px;
  background: var(--glass-bg);
  border-radius: 15px;
  border: 1px solid var(--glass-border);
  transition: all var(--transition-smooth);
  position: relative;
  overflow: hidden;
}

.step-item:hover {
  transform: translateX(10px);
  border-color: var(--primary-blue);
  box-shadow: var(--shadow-medium);
}

.step-number {
  width: 40px;
  height: 40px;
  min-width: 40px;
  background: var(--gradient-primary);
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 900;
  font-size: 1.2rem;
  position: relative;
  z-index: 2;
  box-shadow: 0 5px 15px rgba(14, 165, 233, 0.3);
}

.step-content {
  flex: 1;
}

.step-title {
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--dark-blue);
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 10px;
}

[data-theme="dark"] .step-title {
  color: #E0F2FE;
}

.step-title i {
  color: var(--primary-blue);
  font-size: 1rem;
}

.step-description {
  font-size: 0.95rem;
  color: var(--dark-blue);
  opacity: 0.8;
  line-height: 1.5;
}

[data-theme="dark"] .step-description {
  color: #E0F2FE;
  opacity: 0.7;
}

.step-divider {
  height: 20px;
  width: 2px;
  background: var(--gradient-primary);
  margin-left: 20px;
  position: relative;
  opacity: 0.5;
}

.step-divider::before {
  content: '';
  position: absolute;
  top: -5px;
  left: -3px;
  width: 8px;
  height: 8px;
  background: var(--primary-blue);
  border-radius: 50%;
  animation: pulseDot 2s infinite;
}

@keyframes pulseDot {
  0%, 100% { transform: scale(1); opacity: 0.5; }
  50% { transform: scale(1.2); opacity: 1; }
}

@media (max-width: 768px) {
  .booking-steps {
    padding: 25px 20px;
  }
  
  .step-item {
    padding: 15px;
  }
  
  .step-divider {
    display: none;
  }
}

/* Features Section */
.features-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  margin-top: 40px;
}

@media (max-width: 768px) {
  .features-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 480px) {
  .features-grid {
    grid-template-columns: 1fr;
  }
}

.feature-item {
  text-align: center;
  padding: 20px;
  background: var(--gradient-glass);
  border-radius: 15px;
  transition: all var(--transition-smooth);
}

.feature-item:hover {
  transform: translateY(-5px);
  background: var(--gradient-primary);
}

.feature-item:hover .feature-icon,
.feature-item:hover .feature-text {
  color: white;
}

.feature-icon {
  font-size: 28px;
  color: var(--primary-blue);
  margin-bottom: 12px;
  transition: all var(--transition-smooth);
}

.feature-text {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--dark-blue);
  transition: all var(--transition-smooth);
}

[data-theme="dark"] .feature-text {
  color: #E0F2FE;
}

/* ===================== ENHANCED RESULTS CARD ===================== */
.results-card-enhanced {
  background: var(--glass-bg);
  backdrop-filter: blur(30px);
  -webkit-backdrop-filter: blur(30px);
  border-radius: 30px;
  box-shadow: var(--shadow-medium);
  border: 1px solid var(--glass-border);
  overflow: hidden;
  min-height: 600px;
  display: flex;
  flex-direction: column;
  transition: all var(--transition-smooth);
}

.results-card-enhanced:hover {
  box-shadow: var(--shadow-hard);
  border-color: var(--primary-blue);
}

.results-header-enhanced {
  background: var(--gradient-primary);
  color: white;
  padding: 50px 40px;
  text-align: center;
  position: relative;
  overflow: hidden;
}

.results-header-enhanced::before {
  content: '';
  position: absolute;
  width: 300px;
  height: 300px;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
  top: -150px;
  left: -150px;
}

.results-header-enhanced::after {
  content: '';
  position: absolute;
  width: 200px;
  height: 200px;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.05) 0%, transparent 70%);
  bottom: -100px;
  right: -100px;
}

.results-title-enhanced {
  font-size: 2.5rem;
  font-weight: 900;
  margin-bottom: 10px;
  position: relative;
  z-index: 2;
  text-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
}

.results-subtitle-enhanced {
  font-size: 1.1rem;
  opacity: 0.9;
  position: relative;
  z-index: 2;
  font-weight: 500;
}

.results-body-enhanced {
  padding: 50px 40px;
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Enhanced No Results State */
.no-results-enhanced {
  text-align: center;
  padding: 60px 20px;
  animation: fadeIn 1s ease;
}

.no-results-icon-container {
  width: 120px;
  height: 120px;
  margin: 0 auto 30px;
  position: relative;
}

.no-results-icon {
  font-size: 60px;
  color: var(--primary-blue);
  animation: bounce 2s ease-in-out infinite;
  position: relative;
  z-index: 2;
}

.no-results-icon-bg {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: var(--gradient-glass);
  border-radius: 50%;
  animation: pulse 2s ease-in-out infinite;
}

@keyframes bounce {
  0%, 100% { transform: translateY(0) scale(1); }
  50% { transform: translateY(-20px) scale(1.1); }
}

@keyframes pulse {
  0%, 100% { transform: scale(1); opacity: 0.5; }
  50% { transform: scale(1.1); opacity: 0.7; }
}

.no-results-title-enhanced {
  font-size: 1.8rem;
  font-weight: 800;
  margin-bottom: 15px;
  color: var(--dark-blue);
  background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* ===================== ENHANCED BOOKING DETAILS ===================== */
.booking-details-enhanced {
  width: 100%;
  animation: slideUpEnhanced 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes slideUpEnhanced {
  from { 
    opacity: 0; 
    transform: translateY(50px) scale(0.95); 
  }
  to { 
    opacity: 1; 
    transform: translateY(0) scale(1); 
  }
}

.passenger-card-enhanced {
  background: var(--gradient-glass);
  border-radius: 25px;
  padding: 40px;
  text-align: center;
  margin-bottom: 40px;
  border: 1px solid var(--glass-border);
  position: relative;
  overflow: hidden;
  animation: cardAppear 0.6s ease 0.2s backwards;
}

@keyframes cardAppear {
  from { opacity: 0; transform: translateY(30px); }
  to { opacity: 1; transform: translateY(0); }
}

.passenger-card-enhanced::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 6px;
  height: 100%;
  background: var(--gradient-primary);
  border-radius: 3px 0 0 3px;
}

.passenger-avatar-enhanced {
  width: 100px;
  height: 100px;
  background: var(--gradient-primary);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 42px;
  margin: 0 auto 25px;
  border: 4px solid var(--glass-bg);
  box-shadow: 
    0 15px 35px rgba(14, 165, 233, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
  position: relative;
  overflow: hidden;
  animation: avatarAppear 0.8s ease 0.4s backwards;
}

@keyframes avatarAppear {
  from { 
    opacity: 0; 
    transform: scale(0) rotate(-180deg); 
  }
  to { 
    opacity: 1; 
    transform: scale(1) rotate(0deg); 
  }
}

.passenger-name-enhanced {
  font-size: 2.2rem;
  font-weight: 900;
  margin-bottom: 10px;
  color: var(--dark-blue);
  position: relative;
  display: inline-block;
}

.passenger-name-enhanced::after {
  content: '';
  position: absolute;
  bottom: -5px;
  left: 50%;
  transform: translateX(-50%);
  width: 100px;
  height: 4px;
  background: var(--gradient-primary);
  border-radius: 2px;
}

/* Enhanced Ticket Grid */
.ticket-grid-enhanced {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 25px;
  margin-bottom: 40px;
}

@media (max-width: 768px) {
  .ticket-grid-enhanced {
    grid-template-columns: 1fr;
  }
}

.ticket-card-enhanced {
  background: var(--glass-bg);
  padding: 30px;
  border-radius: 20px;
  border: 1px solid var(--glass-border);
  transition: all var(--transition-smooth);
  position: relative;
  overflow: hidden;
  animation: cardAppear 0.6s ease var(--delay) backwards;
}

.ticket-card-enhanced:hover {
  transform: translateY(-10px);
  border-color: var(--primary-blue);
  box-shadow: var(--shadow-hard);
}

.ticket-card-enhanced:nth-child(1) { --delay: 0.6s; }
.ticket-card-enhanced:nth-child(2) { --delay: 0.7s; }
.ticket-card-enhanced:nth-child(3) { --delay: 0.8s; }
.ticket-card-enhanced:nth-child(4) { --delay: 0.9s; }

.ticket-icon-enhanced {
  width: 60px;
  height: 60px;
  background: var(--gradient-primary);
  border-radius: 15px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 24px;
  margin-bottom: 20px;
  position: relative;
  overflow: hidden;
}

.ticket-icon-enhanced::before {
  content: '';
  position: absolute;
  width: 100%;
  height: 100%;
  background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.3), transparent 70%);
  animation: shine 2s infinite;
}

.ticket-label-enhanced {
  font-size: 0.9rem;
  color: var(--dark-blue);
  text-transform: uppercase;
  letter-spacing: 1.5px;
  margin-bottom: 12px;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 10px;
  opacity: 0.8;
}

[data-theme="dark"] .ticket-label-enhanced {
  color: #E0F2FE;
}

.ticket-value-enhanced {
  font-size: 1.5rem;
  font-weight: 900;
  color: var(--dark-blue);
  line-height: 1.4;
}

[data-theme="dark"] .ticket-value-enhanced {
  color: #F1F5F9;
}

/* Interactive Seats Section */
.seats-section-enhanced {
  background: var(--gradient-glass);
  padding: 40px;
  border-radius: 25px;
  border: 2px dashed var(--glass-border);
  margin-bottom: 40px;
  position: relative;
  overflow: hidden;
  animation: cardAppear 0.6s ease 1s backwards;
}

.seats-section-enhanced::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='50' cy='50' r='2' fill='rgba(14, 165, 233, 0.1)'/%3E%3C/svg%3E");
  animation: moveBackground 20s linear infinite;
}

@keyframes moveBackground {
  0% { transform: translate(0, 0); }
  100% { transform: translate(100px, 100px); }
}

.seats-title-enhanced {
  font-size: 1.8rem;
  font-weight: 900;
  color: var(--dark-blue);
  margin-bottom: 30px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 15px;
  position: relative;
  z-index: 2;
}

[data-theme="dark"] .seats-title-enhanced {
  color: #F1F5F9;
}

.seats-container-enhanced {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  justify-content: center;
  position: relative;
  z-index: 2;
}

.seat-enhanced {
  width: 90px;
  height: 90px;
  border-radius: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: var(--gradient-primary);
  color: white;
  font-weight: 900;
  position: relative;
  overflow: hidden;
  border: 3px solid var(--glass-bg);
  box-shadow: 
    0 10px 30px rgba(14, 165, 233, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
  transition: all var(--transition-bounce);
  cursor: pointer;
  animation: seatAppear 0.5s ease-out backwards;
  animation-delay: calc(var(--index) * 0.1s);
}

@keyframes seatAppear {
  from {
    opacity: 0;
    transform: scale(0.5) rotate(-180deg);
  }
  to {
    opacity: 1;
    transform: scale(1) rotate(0deg);
  }
}

.seat-enhanced::before {
  content: '';
  position: absolute;
  top: -2px;
  left: -2px;
  right: -2px;
  bottom: -2px;
  background: linear-gradient(45deg, 
    var(--primary-blue), 
    var(--secondary-blue), 
    var(--accent-blue), 
    var(--primary-blue));
  border-radius: 22px;
  z-index: -1;
  opacity: 0;
  transition: opacity var(--transition-smooth);
}

.seat-enhanced:hover::before {
  opacity: 1;
  animation: borderRotate 2s linear infinite;
}

@keyframes borderRotate {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.seat-enhanced:hover {
  transform: scale(1.2) rotate(10deg);
  box-shadow: 
    0 20px 50px rgba(14, 165, 233, 0.5),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
  z-index: 10;
}

.seat-icon-enhanced {
  font-size: 28px;
  margin-bottom: 10px;
}

.seat-number-enhanced {
  font-size: 1.3rem;
}

/* Enhanced Download Button */
.download-section-enhanced {
  margin-top: 40px;
  text-align: center;
  animation: cardAppear 0.6s ease 1.2s backwards;
}

.download-btn-enhanced {
  display: inline-flex;
  align-items: center;
  gap: 15px;
  padding: 22px 45px;
  background: var(--gradient-primary);
  color: white;
  border: none;
  border-radius: 20px;
  font-size: 1.2rem;
  font-weight: 900;
  cursor: pointer;
  transition: all var(--transition-bounce);
  box-shadow: 
    0 15px 40px rgba(14, 165, 233, 0.4),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
  position: relative;
  overflow: hidden;
}

.download-btn-enhanced::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
  transition: left 0.7s;
}

.download-btn-enhanced:hover::before {
  left: 100%;
}

.download-btn-enhanced:hover {
  transform: translateY(-5px) scale(1.05);
  box-shadow: 
    0 20px 50px rgba(14, 165, 233, 0.6),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
}

/* Enhanced Feedback */
.feedback-section-enhanced {
  margin-top: 40px;
  padding: 40px;
  background: var(--gradient-glass);
  border-radius: 25px;
  border: 1px solid var(--glass-border);
  text-align: center;
  animation: cardAppear 0.6s ease 1.4s backwards;
}

.feedback-title-enhanced {
  font-size: 1.4rem;
  font-weight: 900;
  color: var(--dark-blue);
  margin-bottom: 25px;
}

[data-theme="dark"] .feedback-title-enhanced {
  color: #F1F5F9;
}

.feedback-buttons-enhanced {
  display: flex;
  gap: 20px;
  justify-content: center;
  flex-wrap: wrap;
}

@media (max-width: 480px) {
  .feedback-buttons-enhanced {
    flex-direction: column;
  }
}

.feedback-btn-enhanced {
  padding: 18px 36px;
  border-radius: 18px;
  border: 2px solid var(--glass-border);
  background: var(--glass-bg);
  color: var(--dark-blue);
  font-weight: 700;
  cursor: pointer;
  transition: all var(--transition-smooth);
  display: flex;
  align-items: center;
  gap: 12px;
  min-width: 160px;
  justify-content: center;
  font-size: 1.1rem;
}

[data-theme="dark"] .feedback-btn-enhanced {
  color: #E0F2FE;
}

.feedback-btn-enhanced.yes:hover {
  background: rgba(16, 185, 129, 0.2);
  border-color: #10B981;
  color: #10B981;
}

.feedback-btn-enhanced.no:hover {
  background: rgba(239, 68, 68, 0.2);
  border-color: #EF4444;
  color: #EF4444;
}

/* ===================== ENHANCED THEME TOGGLE ===================== */
.theme-toggle-enhanced {
  position: fixed;
  bottom: 40px;
  right: 40px;
  z-index: 1000;
}

.theme-btn-enhanced {
  width: 64px;
  height: 64px;
  background: var(--glass-bg);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 2px solid var(--glass-border);
  border-radius: 50%;
  color: var(--dark-blue);
  font-size: 1.4rem;
  cursor: pointer;
  transition: all var(--transition-bounce);
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: var(--shadow-hard);
}

.theme-btn-enhanced:hover {
  transform: rotate(180deg) scale(1.1);
  box-shadow: 0 25px 60px rgba(14, 165, 233, 0.4);
  border-color: var(--primary-blue);
}

/* ===================== ENHANCED FOOTER ===================== */
.footer-enhanced {
  text-align: center;
  padding: 50px 0;
  color: var(--dark-blue);
  font-size: 1rem;
  border-top: 1px solid var(--glass-border);
  margin-top: 60px;
  position: relative;
  overflow: hidden;
}

.company-name-enhanced {
  font-weight: 900;
  color: var(--primary-blue);
  display: block;
  margin-bottom: 10px;
  font-size: 1.3rem;
  position: relative;
  display: inline-block;
}

.company-name-enhanced::after {
  content: '';
  position: absolute;
  bottom: -5px;
  left: 0;
  width: 100%;
  height: 3px;
  background: var(--gradient-primary);
  border-radius: 2px;
  transform: scaleX(0);
  transition: transform 0.6s ease;
}

.company-name-enhanced:hover::after {
  transform: scaleX(1);
}

/* ===================== LOADING STATES ===================== */
.loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(14, 165, 233, 0.95);
  backdrop-filter: blur(20px);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

.loading-content {
  text-align: center;
}

.loading-lottie {
  width: 200px;
  height: 200px;
  margin-bottom: 30px;
}

.loading-text {
  font-size: 1.4rem;
  font-weight: 700;
  color: white;
  letter-spacing: 2px;
}

/* ===================== RESPONSIVE DESIGN ===================== */
@media (max-width: 768px) {
  .modern-header {
    padding: 60px 0 40px;
  }
  
  .brand-title {
    font-size: 2.5rem;
  }
  
  .brand-subtitle {
    font-size: 1.1rem;
    padding: 0 20px;
  }
  
  .search-card-advanced,
  .results-card-enhanced {
    padding: 30px;
  }
  
  .card-title-advanced {
    font-size: 1.6rem;
  }
  
  .results-title-enhanced {
    font-size: 2rem;
  }
  
  .passenger-name-enhanced {
    font-size: 1.8rem;
  }
  
  .seat-enhanced {
    width: 75px;
    height: 75px;
  }
  
  .theme-toggle-enhanced {
    bottom: 20px;
    right: 20px;
  }
  
  .theme-btn-enhanced {
    width: 56px;
    height: 56px;
    font-size: 1.2rem;
  }
}

/* ===================== CUSTOM SCROLLBAR ===================== */
::-webkit-scrollbar {
  width: 12px;
}

::-webkit-scrollbar-track {
  background: var(--glass-bg);
  backdrop-filter: blur(10px);
}

::-webkit-scrollbar-thumb {
  background: var(--gradient-primary);
  border-radius: 6px;
  border: 3px solid var(--glass-bg);
}

::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(135deg, var(--secondary-blue), var(--primary-blue));
}

/* ===================== ANIMATION CLASSES ===================== */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.fade-in {
  animation: fadeIn 0.6s ease;
}

.pulse {
  animation: pulse 2s infinite;
}
</style>
</head>
<body>
<!-- Animated Background -->
<div class="animated-bg">
  <div class="floating-element"></div>
  <div class="floating-element"></div>
  <div class="floating-element"></div>
</div>

<!-- Loading Overlay -->
<div class="loading-overlay" id="loadingOverlay">
  <div class="loading-content">
    <div class="loading-lottie" id="loadingAnimation"></div>
    <div class="loading-text">Loading Your Experience...</div>
  </div>
</div>

<!-- Modern Glass Header -->
<header class="modern-header">
  <div class="header-background"></div>
  <div class="bus-path"></div>
  
  <div class="header-content">
    <div class="animated-logo">
      <div class="logo-main">
        <i class="fas fa-bus"></i>
      </div>
    </div>
    
    <h1 class="brand-title">Welcome To Lagan Bus Booking</h1>
    
    <p class="brand-subtitle">Safe Travels. May God Bless Your Journey.</p>
    
    <div class="contact-chip">
      <i class="fas fa-phone-alt"></i>
      <span>For Reservations: <strong>0777 402 886</strong> (Mr. Fawas)</span>
    </div>
  </div>
</header>

<!-- Stats Section -->
<div class="container">
  <div class="stats-container">
    <div class="stat-card">
      <div class="stat-icon">
        <i class="fas fa-users"></i>
      </div>
      <span class="stat-number" id="passengerCount">0+</span>
      <div class="stat-label">Happy Passengers</div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">
        <i class="fas fa-bus"></i>
      </div>
      <span class="stat-number" id="busCount">0+</span>
      <div class="stat-label">Comforable Buses</div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">
        <i class="fas fa-headset"></i>
      </div>
      <span class="stat-number" id="customerServiceCount">0%</span>
      <div class="stat-label">Customer Service</div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">
        <i class="fas fa-check-circle"></i>
      </div>
      <span class="stat-number" id="bookingCount">0%</span>
      <div class="stat-label">Booking Accuracy</div>
    </div>
  </div>
</div>

<!-- Theme Toggle -->
<div class="theme-toggle-enhanced">
  <button class="theme-btn-enhanced" id="themeToggle">
    <i class="fas fa-moon" id="themeIcon"></i>
  </button>
</div>

<!-- Main Content -->
<div class="container">
  <main class="main-content">
    
    <!-- Advanced Search Card -->
    <div class="search-card-advanced" role="region" aria-label="Check Booking">
      <div class="card-header-advanced">
        <div class="card-icon-advanced">
          <i class="fas fa-search"></i>
        </div>
        <h2 class="card-title-advanced">Check Your Booking</h2>
      </div>
      
      <div class="input-group-advanced">
        <label class="input-label-advanced" for="phone">
          <i class="fas fa-mobile-alt"></i>
          Phone Number
        </label>
        <div class="input-wrapper-advanced">
          <i class="input-icon-advanced fas fa-phone"></i>
          <input type="tel" id="phone" class="input-field-advanced" 
                 placeholder="Enter 10-digit number (077XXXXXXX)" 
                 maxlength="10" inputmode="tel" aria-label="Phone number">
        </div>
      </div>
      
      <button id="searchBtn" class="search-btn-advanced" aria-label="Check my booking">
        <i class="fas fa-search"></i> Check My Booking
      </button>
      
      <!-- Booking Steps Section -->
      <div class="booking-steps">
        <h3 class="steps-title">
          <i class="fas fa-info-circle"></i>
          How to Check Your Booking
        </h3>
        
        <div class="steps-container">
          <div class="step-item">
            <div class="step-number">1</div>
            <div class="step-content">
              <h4 class="step-title">
                <i class="fas fa-phone-alt"></i>
                Enter Phone Number
              </h4>
              <p class="step-description">Type the 10-digit phone number you used for booking (e.g., 077XXXXXXX)</p>
            </div>
          </div>
          
          <div class="step-divider"></div>
          
          <div class="step-item">
            <div class="step-number">2</div>
            <div class="step-content">
              <h4 class="step-title">
                <i class="fas fa-search"></i>
                Click Check Booking
              </h4>
              <p class="step-description">Press the "Check My Booking" button to search our database</p>
            </div>
          </div>
          
          <div class="step-divider"></div>
          
          <div class="step-item">
            <div class="step-number">3</div>
            <div class="step-content">
              <h4 class="step-title">
                <i class="fas fa-ticket-alt"></i>
                View & Download Ticket
              </h4>
              <p class="step-description">See your booking details and download your e-ticket instantly</p>
            </div>
          </div>
        </div>
      </div>
      
      <div class="features-grid">
        <div class="feature-item">
          <div class="feature-icon">
            <i class="fas fa-shield-alt"></i>
          </div>
          <div class="feature-text">Secure Booking</div>
        </div>
        
        <div class="feature-item">
          <div class="feature-icon">
            <i class="fas fa-bolt"></i>
          </div>
          <div class="feature-text">Instant Results</div>
        </div>
        
        <div class="feature-item">
          <div class="feature-icon">
            <i class="fas fa-download"></i>
          </div>
          <div class="feature-text">E-Ticket Download</div>
        </div>
      </div>
    </div>
    
    <!-- Enhanced Results Card -->
    <div class="results-card-enhanced" role="region" aria-label="Booking details">
      <div class="results-header-enhanced">
        <h2 class="results-title-enhanced">Your Booking Details</h2>
        <p class="results-subtitle-enhanced">Find all your travel information here</p>
      </div>
      
      <div class="results-body-enhanced" id="resultsBody">
        <!-- Initial state -->
        <div class="no-results-enhanced" aria-live="polite">
          <div class="no-results-icon-container">
            <div class="no-results-icon-bg"></div>
            <div class="no-results-icon">
              <i class="fas fa-bus"></i>
            </div>
          </div>
          <h3 class="no-results-title-enhanced">Ready to Check Your Booking?</h3>
          <p style="color: var(--dark-blue); opacity: 0.7; max-width: 400px; margin: 0 auto;">
            Enter your phone number above to access your premium booking details instantly
          </p>
        </div>
        
        <!-- Booking Details -->
        <div id="bookingDetails" style="display: none;" class="booking-details-enhanced">
          <!-- Passenger Info -->
          <div class="passenger-card-enhanced">
            <div class="passenger-avatar-enhanced">
              <i class="fas fa-user"></i>
            </div>
            <div class="ticket-label-enhanced" style="margin-bottom: 10px;">
              <i class="fas fa-user-tag"></i>
              PASSENGER INFORMATION
            </div>
            <h3 id="passengerName" class="passenger-name-enhanced">-</h3>
            <p class="passenger-id" id="bookingId" style="color: var(--dark-blue); opacity: 0.7; margin-top: 10px;">Booking ID: -</p>
          </div>
          
          <!-- Ticket Info Grid -->
          <div class="ticket-grid-enhanced">
            <div class="ticket-card-enhanced">
              <div class="ticket-icon-enhanced">
                <i class="fas fa-bus"></i>
              </div>
              <div class="ticket-label-enhanced">
                <i class="fas fa-tag"></i>
                BUS NAME
              </div>
              <div id="busName" class="ticket-value-enhanced">-</div>
            </div>
            
            <div class="ticket-card-enhanced">
              <div class="ticket-icon-enhanced">
                <i class="far fa-calendar-alt"></i>
              </div>
              <div class="ticket-label-enhanced">
                <i class="far fa-clock"></i>
                DATE & TIME
              </div>
              <div id="dateTime" class="ticket-value-enhanced">-</div>
            </div>
            
            <div class="ticket-card-enhanced">
              <div class="ticket-icon-enhanced">
                <i class="fas fa-map-marker-alt"></i>
              </div>
              <div class="ticket-label-enhanced">
                <i class="fas fa-location-arrow"></i>
                PICKUP LOCATION
              </div>
              <div id="pickupLocation" class="ticket-value-enhanced">-</div>
            </div>
            
            <div class="ticket-card-enhanced">
              <div class="ticket-icon-enhanced">
                <i class="fas fa-money-bill-wave"></i>
              </div>
              <div class="ticket-label-enhanced">
                <i class="fas fa-credit-card"></i>
                PAYMENT STATUS
              </div>
              <div id="paymentAmount" class="ticket-value-enhanced">-</div>
            </div>
          </div>
          
          <!-- Seats Section -->
          <div class="seats-section-enhanced">
            <h3 class="seats-title-enhanced">
              <i class="fas fa-chair"></i>
              YOUR SEAT NUMBERS
            </h3>
            <div class="seats-container-enhanced" id="seatsBox" aria-live="polite"></div>
          </div>
          
          <!-- Download Button -->
          <div class="download-section-enhanced">
            <button id="downloadBtn" class="download-btn-enhanced">
              <i class="fas fa-download"></i> DOWNLOAD TICKET
            </button>
          </div>
          
          <!-- Feedback Section -->
          <div id="feedbackSection" class="feedback-section-enhanced" style="display: none;">
            <h3 class="feedback-title-enhanced">Did you receive your correct seat information?</h3>
            <div class="feedback-buttons-enhanced">
              <button class="feedback-btn-enhanced yes" onclick="sendFeedback('Yes')">
                <i class="fas fa-thumbs-up"></i> Yes, All Good
              </button>
              <button class="feedback-btn-enhanced no" onclick="sendFeedback('No')">
                <i class="fas fa-thumbs-down"></i> No, Issue Found
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
  
  <!-- Enhanced Footer -->
  <footer class="footer-enhanced" role="contentinfo">
    <span class="company-name-enhanced">WEDOXA</span>
    <p style="margin-top: 15px; opacity: 0.8;">Made with <span style="color:#ef4444;">❤</span> by WEDOXA</p>
    <p style="margin-top: 10px; font-size: 0.9rem; opacity: 0.6;">
      &copy; 2024 Lagan Bus Booking. All rights reserved.
    </p>
  </footer>
</div>

<!-- JavaScript -->
<script>
// ===================== ENHANCED INITIALIZATION =====================
document.addEventListener('DOMContentLoaded', function() {
  // Show loading animation briefly
  document.getElementById('loadingOverlay').style.display = 'flex';
  
  // Load Lottie animation
  const animationContainer = document.getElementById('loadingAnimation');
  if (animationContainer) {
    lottie.loadAnimation({
      container: animationContainer,
      renderer: 'svg',
      loop: true,
      autoplay: true,
      path: 'https://assets5.lottiefiles.com/packages/lf20_kdxrj6nb.json'
    });
  }
  
  // Hide loading after 1.5 seconds
  setTimeout(() => {
    document.getElementById('loadingOverlay').style.display = 'none';
    
    // Animate stats counting with staggered start
    setTimeout(animateStats, 500);
    
    // Initialize theme
    const savedTheme = localStorage.getItem('lagan-theme') || 'light';
    document.documentElement.setAttribute('data-theme', savedTheme);
    updateThemeUI(savedTheme);
    
    // Add click to re-animate stats
    document.querySelectorAll('.stat-card').forEach(card => {
      card.addEventListener('click', function() {
        const numberElement = this.querySelector('.stat-number');
        const id = numberElement.id;
        
        // Find counter config
        const counters = [
          { element: 'passengerCount', end: 10000, suffix: '+' },
          { element: 'busCount', end: 50, suffix: '+' },
          { element: 'customerServiceCount', end: 100, suffix: '%' },
          { element: 'bookingCount', end: 99, suffix: '%' }
        ];
        
        const counter = counters.find(c => c.element === id);
        if (counter) {
          // Reset and re-animate this specific counter
          numberElement.textContent = '0' + counter.suffix;
          animateSingleStat(counter);
          
          // Add visual feedback
          this.style.transform = 'translateY(-5px) scale(1.05)';
          setTimeout(() => {
            this.style.transform = '';
          }, 300);
        }
      });
    });
  }, 1500);

  // Theme toggle with enhanced animation
  const themeToggle = document.getElementById('themeToggle');
  themeToggle.addEventListener('click', function() {
    const currentTheme = document.documentElement.getAttribute('data-theme');
    const newTheme = currentTheme === 'light' ? 'dark' : 'light';
    
    // Add enhanced animation
    this.style.transform = 'rotate(180deg) scale(0.9)';
    setTimeout(() => {
      document.documentElement.setAttribute('data-theme', newTheme);
      updateThemeUI(newTheme);
      localStorage.setItem('lagan-theme', newTheme);
      this.style.transform = 'rotate(360deg) scale(1)';
    }, 300);
  });

  // Phone input with enhanced validation
  const phoneInput = document.getElementById('phone');
  phoneInput.addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    if (value.length > 10) value = value.substring(0, 10);
    e.target.value = value;
    
    // Visual feedback
    const icon = this.parentNode.querySelector('.input-icon-advanced');
    if (value.length === 10) {
      this.style.borderColor = '#10B981';
      icon.style.color = '#10B981';
      icon.classList.add('pulse');
    } else if (value.length >= 9) {
      this.style.borderColor = '#F59E0B';
      icon.style.color = '#F59E0B';
      icon.classList.remove('pulse');
    } else {
      this.style.borderColor = '';
      icon.style.color = '';
      icon.classList.remove('pulse');
    }
  });

  // Enhanced search button
  const searchBtn = document.getElementById('searchBtn');
  searchBtn.addEventListener('mouseenter', function() {
    this.style.transform = 'translateY(-5px) scale(1.02)';
  });
  
  searchBtn.addEventListener('mouseleave', function() {
    this.style.transform = 'translateY(0) scale(1)';
  });

  // Enter key to search
  phoneInput.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') searchBooking();
  });

  // Search button event
  searchBtn.addEventListener('click', searchBooking);

  // Download button event
  document.getElementById('downloadBtn').addEventListener('click', downloadTicket);
  
  // Auto-focus with animation
  setTimeout(() => {
    phoneInput.focus();
    phoneInput.style.transform = 'scale(1.02)';
    phoneInput.style.boxShadow = '0 0 0 3px rgba(14, 165, 233, 0.1)';
    setTimeout(() => {
      phoneInput.style.transform = '';
      phoneInput.style.boxShadow = '';
    }, 500);
  }, 2000);
});

// Animate stats counting for all stats
function animateStats() {
  const counters = [
    { element: 'passengerCount', end: 10000, suffix: '+' },
    { element: 'busCount', end: 50, suffix: '+' },
    { element: 'customerServiceCount', end: 100, suffix: '%' },
    { element: 'bookingCount', end: 99, suffix: '%' }
  ];
  
  // Reset all counters to 0 first
  counters.forEach(counter => {
    const element = document.getElementById(counter.element);
    if (element) {
      element.textContent = '0' + counter.suffix;
    }
  });
  
  // Animate each counter
  counters.forEach(counter => {
    const element = document.getElementById(counter.element);
    if (!element) return;
    
    // Add visual animation to the stat card
    const statCard = element.closest('.stat-card');
    if (statCard) {
      statCard.style.transform = 'translateY(10px)';
      statCard.style.opacity = '0.8';
    }
    
    let start = 0;
    const duration = 2000; // 2 seconds
    const increment = counter.end / (duration / 16); // 60fps
    
    const timer = setInterval(() => {
      start += increment;
      if (start >= counter.end) {
        element.textContent = counter.end + counter.suffix;
        clearInterval(timer);
        
        // Add completion animation
        if (statCard) {
          statCard.style.transform = 'translateY(0)';
          statCard.style.opacity = '1';
          
          // Add celebration effect for 100% and 99%
          if (counter.element === 'customerServiceCount' || counter.element === 'bookingCount') {
            const icon = statCard.querySelector('.stat-icon');
            if (icon) {
              icon.style.transform = 'scale(1.2)';
              icon.style.boxShadow = '0 0 30px rgba(14, 165, 233, 0.6)';
              setTimeout(() => {
                icon.style.transform = 'scale(1)';
                icon.style.boxShadow = '';
              }, 300);
            }
          }
        }
      } else {
        // Format number with comma for large numbers
        let displayNum = Math.floor(start);
        if (counter.end >= 1000) {
          displayNum = displayNum.toLocaleString();
        }
        element.textContent = displayNum + counter.suffix;
      }
    }, 16);
  });
}

// Function to animate a single stat
function animateSingleStat(counter) {
  const element = document.getElementById(counter.element);
  if (!element) return;
  
  const statCard = element.closest('.stat-card');
  const icon = statCard.querySelector('.stat-icon');
  
  // Add pulse effect to icon
  if (icon) {
    icon.style.animation = 'pulse 0.5s ease';
    setTimeout(() => {
      icon.style.animation = '';
    }, 500);
  }
  
  let start = 0;
  const duration = 1500; // 1.5 seconds
  const increment = counter.end / (duration / 16);
  
  const timer = setInterval(() => {
    start += increment;
    if (start >= counter.end) {
      element.textContent = counter.end + counter.suffix;
      clearInterval(timer);
      
      // Celebration effect
      if (icon) {
        icon.style.transform = 'scale(1.1) rotate(360deg)';
        icon.style.transition = 'all 0.5s ease';
        setTimeout(() => {
          icon.style.transform = '';
        }, 500);
      }
    } else {
      let displayNum = Math.floor(start);
      if (counter.end >= 1000) {
        displayNum = displayNum.toLocaleString();
      }
      element.textContent = displayNum + counter.suffix;
    }
  }, 16);
}

function updateThemeUI(theme) {
  const themeIcon = document.getElementById('themeIcon');
  
  if (theme === 'dark') {
    themeIcon.className = 'fas fa-sun';
  } else {
    themeIcon.className = 'fas fa-moon';
  }
}

// ===================== ENHANCED SEARCH FUNCTION =====================
function searchBooking() {
  const phone = document.getElementById('phone').value.trim();
  const btn = document.getElementById('searchBtn');

  if (!phone || phone.length < 9) {
    Swal.fire({
      icon: 'warning',
      title: 'Enter Phone Number',
      text: 'Please enter a valid 10-digit phone number',
      confirmButtonColor: '#0EA5E9',
      background: 'var(--glass-bg)',
      color: 'var(--dark-blue)',
      customClass: {
        popup: 'glass-card'
      }
    });
    return;
  }

  // Show enhanced loading state
  const originalText = btn.innerHTML;
  btn.innerHTML = '<div class="spinner"></div> Searching...';
  btn.disabled = true;
  document.getElementById('loadingOverlay').style.display = 'flex';

  // Fetch from Google Sheets
  fetch(`${SCRIPT_URL}?phone=${encodeURIComponent(phone)}`)
    .then(response => response.json())
    .then(data => {
      btn.innerHTML = originalText;
      btn.disabled = false;
      document.getElementById('loadingOverlay').style.display = 'none';

      if (!data.success) {
        Swal.fire({
          icon: 'error',
          title: 'No Booking Found',
          text: 'We could not find a booking with this phone number',
          confirmButtonColor: '#0EA5E9',
          background: 'var(--glass-bg)',
          color: 'var(--dark-blue)',
          customClass: {
            popup: 'glass-card'
          }
        });
        return;
      }

      // Display results with enhanced animation
      renderBooking(data.booking);

      // Enhanced scroll animation
      const resultsCard = document.querySelector('.results-card-enhanced');
      resultsCard.style.transform = 'translateY(50px) scale(0.95)';
      resultsCard.style.opacity = '0';
      
      setTimeout(() => {
        resultsCard.scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
        
        resultsCard.style.transition = 'all 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
        resultsCard.style.transform = 'translateY(0) scale(1)';
        resultsCard.style.opacity = '1';
      }, 300);
    })
    .catch(error => {
      btn.innerHTML = originalText;
      btn.disabled = false;
      document.getElementById('loadingOverlay').style.display = 'none';

      Swal.fire({
        icon: 'error',
        title: 'Connection Error',
        text: 'Please check your internet connection and try again',
        confirmButtonColor: '#0EA5E9',
        background: 'var(--glass-bg)',
        color: 'var(--dark-blue)',
        customClass: {
          popup: 'glass-card'
        }
      });
      console.error('Error:', error);
    });
}

// ===================== ENHANCED RENDER FUNCTION =====================
function renderBooking(b) {
  function getField(obj, possibleNames) {
    if (!obj) return null;
    for (const name of possibleNames) {
      const keys = Object.keys(obj);
      for (const key of keys) {
        if (key.toLowerCase().replace(/\s+/g, '') === name.toLowerCase().replace(/\s+/g, '')) {
          return obj[key];
        }
      }
    }
    const keys = Object.keys(obj);
    for (const name of possibleNames) {
      if (keys.includes(name)) return obj[name];
    }
    return null;
  }

  const name = getField(b, ['Name', 'Passenger', 'Passenger Name', 'Full Name', 'Customer Name']) || '-';
  const bus = getField(b, ['Bus', 'Bus Name', 'Vehicle', 'Bus Number', 'Service']) || '-';
  const date = getField(b, ['Date', 'Travel Date', 'Journey Date', 'Departure Date', 'Date/Time']) || '';
  const time = getField(b, ['Time', 'Departure Time', 'Travel Time', 'Time Slot']) || '';
  const seat = getField(b, ['Seat', 'Seats', 'Seat Number', 'Seat Numbers', 'Seat No']) || '';
  const pickup = getField(b, ['Pickup', 'Pickup Location', 'Boarding Point', 'Pickup Point']) || '-';
  const payment = getField(b, ['Payment', 'Amount', 'Payment Status', 'Fare', 'Price']) || '-';
  const bookingId = getField(b, ['Booking ID', 'Reference', 'Ref No', 'Ticket No']) || '';

  // Update display with enhanced animations
  const passengerName = document.getElementById('passengerName');
  passengerName.textContent = name;
  passengerName.style.opacity = '0';
  passengerName.style.transform = 'translateY(20px)';
  
  setTimeout(() => {
    passengerName.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
    passengerName.style.opacity = '1';
    passengerName.style.transform = 'translateY(0)';
  }, 200);
  
  document.getElementById('bookingId').textContent = bookingId ? `Booking ID: ${bookingId}` : 'Booking ID: -';
  document.getElementById('busName').textContent = bus;

  const formatted = formatDateTime(date, time);
  let displayDateTime = `${formatted.date} • ${formatted.time}`;
  
  if (displayDateTime.includes('Invalid') || displayDateTime.includes('NaN') || displayDateTime.includes('undefined')) {
    displayDateTime = '-';
  }
  document.getElementById('dateTime').textContent = displayDateTime;
  document.getElementById('pickupLocation').textContent = pickup;

  // Payment display with enhanced styling
  const paymentElement = document.getElementById('paymentAmount');
  const paymentText = (payment && typeof payment === 'string' && payment.trim() !== '') ? payment : 'Not Updated';
  
  // Add visual indicators based on payment status
  if (paymentText.toLowerCase().includes('paid') || paymentText.toLowerCase().includes('complete')) {
    paymentElement.style.color = '#10B981';
  } else if (paymentText.toLowerCase().includes('pending')) {
    paymentElement.style.color = '#F59E0B';
  } else {
    paymentElement.style.color = '';
  }
  
  paymentElement.textContent = paymentText;

  // ===================== ENHANCED SEATS DISPLAY =====================
  const seatsBox = document.getElementById('seatsBox');
  seatsBox.innerHTML = '';
  
  if (seat && String(seat).trim() !== '' && String(seat).trim().toLowerCase() !== 'not updated' && String(seat).trim() !== '-') {
    const seats = String(seat).split(/[, \/]+/).filter(s => s.trim() !== '' && s.trim() !== '-');
    if (seats.length > 0) {
      seats.forEach((seatNum, index) => {
        const seatElement = document.createElement('div');
        seatElement.className = 'seat-enhanced';
        seatElement.style.setProperty('--index', index);
        seatElement.innerHTML = `
          <div class="seat-icon-enhanced"><i class="fas fa-chair"></i></div>
          <div class="seat-number-enhanced">${seatNum.trim()}</div>
        `;
        
        // Add click sound effect simulation
        seatElement.addEventListener('click', function() {
          this.style.transform = 'scale(0.9)';
          setTimeout(() => {
            this.style.transform = 'scale(1.2) rotate(10deg)';
          }, 100);
        });
        
        seatsBox.appendChild(seatElement);
      });
    } else {
      seatsBox.innerHTML = '<div class="no-seats">No seat assigned yet. Please contact Mr. Fawas.</div>';
    }
  } else {
    seatsBox.innerHTML = '<div class="no-seats">No seat assigned yet. Please contact Mr. Fawas.</div>';
  }

  // Show results with enhanced animations
  document.getElementById('bookingDetails').style.display = 'block';
  document.getElementById('feedbackSection').style.display = 'block';
  
  const noResults = document.getElementById('resultsBody').querySelector('.no-results-enhanced');
  if (noResults) {
    noResults.style.opacity = '0';
    noResults.style.transform = 'scale(0.9)';
    setTimeout(() => {
      noResults.style.display = 'none';
    }, 300);
  }

  // Store data for download
  window.currentBookingData = {
    passengerName: name,
    busName: bus,
    dateTime: displayDateTime,
    pickupLocation: pickup,
    paymentAmount: paymentText,
    seats: seat,
    bookingId: bookingId,
    phone: document.getElementById('phone').value.trim()
  };
}

// Configuration
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwKWNQcXnjjzh540oJWgZJsJi1wQMd0PS94pjiHXy7VjlrR95ME2xnveTuDhPvlZScdow/exec";

// Date/Time formatting functions
function formatDateTime(dateStr, timeStr) {
  if (!dateStr || dateStr.trim() === '') return { date: '-', time: '-' };
  try {
    let dateObj;
    if (dateStr.includes('/')) {
      const parts = dateStr.split('/');
      if (parts.length === 3) {
        let day = parseInt(parts[0]);
        let month = parseInt(parts[1]) - 1;
        let year = parseInt(parts[2]);
        if (year < 100) year = 2000 + year;
        dateObj = new Date(year, month, day);
      } else {
        dateObj = new Date(dateStr);
      }
    } else if (dateStr.includes('-')) {
      const parts = dateStr.split('-');
      if (parts.length === 3) {
        let year = parseInt(parts[0]);
        let month = parseInt(parts[1]) - 1;
        let day = parseInt(parts[2]);
        dateObj = new Date(year, month, day);
      } else {
        dateObj = new Date(dateStr);
      }
    } else {
      dateObj = new Date(dateStr);
    }
    return formatDateObj(dateObj, timeStr);
  } catch (e) {
    console.log('Date parse error:', e, 'for date:', dateStr);
    return { date: dateStr, time: timeStr || '-' };
  }
}

function formatDateObj(dateObj, timeStr) {
  if (!(dateObj instanceof Date) || isNaN(dateObj)) {
    return { date: '-', time: timeStr || '-' };
  }
  const options = { weekday: 'short', day: 'numeric', month: 'short', year: 'numeric' };
  const date = dateObj.toLocaleDateString('en-US', options);
  const time = timeStr ? formatTimeString(timeStr) : '-';
  return { date, time };
}

function formatTimeString(timeStr) {
  if (!timeStr) return '-';
  const cleaned = timeStr.toString().toLowerCase().replace(/\s/g, '');
  if (cleaned.includes('am') || cleaned.includes('pm')) {
    return timeStr.trim();
  }
  if (cleaned.includes(':')) {
    const [hours, minutes] = cleaned.split(':');
    let h = parseInt(hours);
    const m = minutes ? parseInt(minutes) : 0;
    const ampm = h >= 12 ? 'PM' : 'AM';
    h = h % 12 || 12;
    return `${h}:${m.toString().padStart(2, '0')} ${ampm}`;
  }
  const num = parseInt(cleaned);
  if (!isNaN(num)) {
    const h = num % 12 || 12;
    const ampm = num >= 12 ? 'PM' : 'AM';
    return `${h}:00 ${ampm}`;
  }
  return timeStr;
}

// Ticket download function
function downloadTicket() {
  if (!window.currentBookingData) {
    Swal.fire({
      icon: 'warning',
      title: 'No Booking Data',
      text: 'Please check your booking first',
      confirmButtonColor: '#0EA5E9'
    });
    return;
  }

  const data = window.currentBookingData;
  document.getElementById('loadingOverlay').style.display = 'flex';

  setTimeout(() => {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF({
      orientation: 'portrait',
      unit: 'mm',
      format: 'a4'
    });

    // Background gradient
    const gradient = doc.context2d.createLinearGradient(0, 0, 210, 0);
    gradient.addColorStop(0, '#0EA5E9');
    gradient.addColorStop(1, '#1D4ED8');
    doc.setFillColor(14, 165, 233);
    doc.rect(0, 0, 210, 50, 'F');

    // Header
    doc.setFontSize(24);
    doc.setTextColor(255, 255, 255);
    doc.setFont('helvetica', 'bold');
    doc.text('LAGAN BUS BOOKING', 105, 25, { align: 'center' });

    doc.setFontSize(12);
    doc.text('E-TICKET', 105, 35, { align: 'center' });

    // Ticket content
    doc.setFillColor(255, 255, 255);
    doc.roundedRect(10, 60, 190, 120, 5, 5, 'F');

    // Passenger info
    doc.setFontSize(18);
    doc.setTextColor(0, 0, 0);
    doc.text('PASSENGER INFORMATION', 20, 75);

    doc.setDrawColor(14, 165, 233);
    doc.setLineWidth(0.5);
    doc.line(20, 78, 190, 78);

    doc.setFontSize(14);
    doc.text(`Name: ${data.passengerName}`, 30, 90);
    doc.text(`Booking ID: ${data.bookingId || '-'}`, 30, 100);
    doc.text(`Phone: ${data.phone}`, 130, 90);

    // Journey details
    doc.setFontSize(16);
    doc.text('JOURNEY DETAILS', 20, 115);

    doc.line(20, 118, 190, 118);

    const details = [
      [`Bus: ${data.busName}`, `Date & Time: ${data.dateTime}`],
      [`Pickup: ${data.pickupLocation}`, `Payment: ${data.paymentAmount}`],
      [`Seats: ${data.seats || 'Not assigned'}`, `Downloaded: ${new Date().toLocaleDateString()}`]
    ];

    let yPos = 130;
    details.forEach(row => {
      doc.setFontSize(12);
      doc.text(row[0], 30, yPos);
      doc.text(row[1], 120, yPos);
      yPos += 15;
    });

    // Footer
    doc.setFontSize(10);
    doc.setTextColor(100, 100, 100);
    doc.text('For any issues, contact Mr. Fawas: 0777 402 886', 105, 200, { align: 'center' });
    doc.text('Thank you for choosing Lagan Bus Booking! Safe travels!', 105, 205, { align: 'center' });

    // Border
    doc.setDrawColor(14, 165, 233);
    doc.setLineWidth(1);
    doc.roundedRect(5, 5, 200, 287, 5, 5);

    const fileName = `Lagan-Ticket-${data.passengerName.replace(/\s+/g, '-')}-${Date.now()}.pdf`;
    doc.save(fileName);

    document.getElementById('loadingOverlay').style.display = 'none';

    Swal.fire({
      icon: 'success',
      title: 'Ticket Downloaded!',
      text: `Your e-ticket has been saved as ${fileName}`,
      confirmButtonColor: '#0EA5E9'
    });
  }, 1000);
}

// Feedback system
function sendFeedback(answer) {
  const clickedBtn = event.target.closest('.feedback-btn-enhanced');
  const originalHTML = clickedBtn.innerHTML;
  clickedBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';
  clickedBtn.disabled = true;

  const bookingData = window.currentBookingData || {};
  const feedbackData = {
    passengerName: bookingData.passengerName || 'Unknown',
    phone: bookingData.phone || document.getElementById('phone').value || 'Unknown',
    answer: answer,
    timestamp: new Date().toISOString(),
    bookingDetails: {
      bus: bookingData.busName || '-',
      dateTime: bookingData.dateTime || '-',
      seats: bookingData.seats || '-'
    }
  };

  setTimeout(() => {
    clickedBtn.innerHTML = originalHTML;
    clickedBtn.disabled = false;

    const title = answer === 'Yes' ? 'Thank You!' : 'We Apologize!';
    const text = answer === 'Yes' 
      ? 'We\'re glad you received correct information. Have a safe journey!' 
      : 'We\'re sorry for the inconvenience. Please contact Mr. Fawas immediately at 0777 402 886.';

    Swal.fire({
      icon: answer === 'Yes' ? 'success' : 'info',
      title: title,
      text: text,
      confirmButtonColor: '#0EA5E9',
      showCancelButton: answer === 'No',
      cancelButtonText: 'Call Support',
      showConfirmButton: true,
      confirmButtonText: 'OK'
    }).then((result) => {
      if (answer === 'No' && result.dismiss === Swal.DismissReason.cancel) {
        window.location.href = 'tel:0777402886';
      }
    });

    console.log('Feedback sent:', feedbackData);
  }, 1500);
}
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</body>
</html>
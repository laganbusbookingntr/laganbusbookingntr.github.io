<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Lagan Bus Booking â€“ Animated</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<style>
:root{
  --blue:#3a7bd5;
  --blue2:#67b8f7;
  --bg:#eef3f8;
  --card:#ffffff;
  --text:#1b2733;
  --muted:#66788A;
  --border:#dce4ec;
}

*{box-sizing:border-box;margin:0;padding:0}

/* ======================================================
   SKY + DAY/NIGHT CYCLE
====================================================== */
.sky-container{
  width:100%;
  max-width:820px;
  height:150px;
  position:relative;
  margin:0 auto 14px auto;
  overflow:hidden;
  border-radius:16px;
  animation: skyCycle 20s linear infinite;
}

@keyframes skyCycle{
  0%   { background:linear-gradient(#bfe4ff,#eaf6ff); }
  20%  { background:linear-gradient(#ffcf9b,#ffa96e); }
  40%  { background:linear-gradient(#2e3160,#1b1d38); }
  60%  { background:linear-gradient(#000010,#000); }
  80%  { background:linear-gradient(#8f6cff,#ffcaf9); }
  100% { background:linear-gradient(#bfe4ff,#eaf6ff); }
}

/* SUN */
.sun{
  width:70px;height:70px;border-radius:50%;
  background:#FFD93D;
  position:absolute;left:30px;bottom:-20px;
  box-shadow:0 0 22px rgba(255,217,61,0.7);
  animation: sunCycle 20s linear infinite;
}

@keyframes sunCycle{
  0%   { transform:translateY(40px); opacity:1 }
  25%  { transform:translateY(-10px); opacity:1 }
  40%  { opacity:0 }
  70%  { opacity:0 }
  90%  { opacity:1; transform:translateY(-10px) }
  100% { opacity:1; transform:translateY(40px) }
}

/* MOON */
.moon{
  width:55px;height:55px;border-radius:50%;
  background:white;
  position:absolute;right:40px;top:28px;
  box-shadow:0 0 12px rgba(255,255,255,0.7);
  opacity:0;
  animation: moonCycle 20s linear infinite;
}

@keyframes moonCycle{
  0%,30% { opacity:0 }
  45%,70% { opacity:1 }
  85%,100% { opacity:0 }
}

/* CLOUDS */
.cloud{
  position:absolute;
  width:55px;height:25px;background:white;
  border-radius:40px;
  box-shadow:20px 8px 0 #fff,40px 12px 0 #fff;
  opacity:0.9;
  animation: cloudMove 25s linear infinite, cloudTint 20s linear infinite;
}
.cloud.c1{ top:20px; }
.cloud.c2{ top:38px; transform:scale(1.3); animation-duration:32s; }
.cloud.c3{ top:65px; transform:scale(0.9); animation-duration:38s; }

@keyframes cloudMove{
  0%{ left:-130px }
  100%{ left:120% }
}
@keyframes cloudTint{
  0%{ filter:brightness(1) }
  40%{ filter:brightness(0.8) }
  60%{ filter:brightness(0.6) }
  80%{ filter:brightness(0.9) }
  100%{ filter:brightness(1) }
}

/* STARS */
.stars{
  position:absolute;top:0;left:0;width:100%;height:100%;
  pointer-events:none;
  background:
    radial-gradient(2px 2px at 20% 30%, white 90%, transparent),
    radial-gradient(2px 2px at 60% 50%, white 90%, transparent),
    radial-gradient(2px 2px at 80% 40%, white 90%, transparent),
    radial-gradient(2px 2px at 30% 80%, white 90%, transparent),
    radial-gradient(2px 2px at 70% 20%, white 90%, transparent);
  opacity:0;
  animation: starCycle 20s linear infinite;
}

@keyframes starCycle{
  0%,30% { opacity:0 }
  40%,70% { opacity:1 }
  90%,100% { opacity:0 }
}

/* SHOOTING STAR */
.shooting-star{
  position:absolute;
  width:3px;height:3px;
  background:white;
  border-radius:50%;
  top:20px;left:-100px;
  box-shadow:0 0 12px white;
  opacity:0;
  animation: shoot 5s ease-in-out infinite;
}

@keyframes shoot{
  0% { transform:translate(0,0); opacity:0; }
  10% { opacity:1; }
  40% { transform:translate(300px,80px); opacity:1; }
  60% { opacity:0.4; }
  100% { opacity:0; transform:translate(500px,140px); }
}

/* ======================================================
   ROAD + BUS + SHADOW (SLOW + FULL WIDTH)
====================================================== */
.road-container{
  width:100%;max-width:820px;height:75px;
  margin:0 auto 20px auto;position:relative;overflow:hidden;
}
.road{
  width:260%;height:10px;
  background:repeating-linear-gradient(
    to right,#444 0px,#444 40px,#fff 40px,#fff 80px
  );
  position:absolute;bottom:0;
  animation: roadMove 5s linear infinite;
}
@keyframes roadMove{
  from{ transform:translateX(0) }
  to{ transform:translateX(-20%) }
}

/* BUS */
.bus-anim{
  font-size:48px;
  position:absolute;
  bottom:20px;
  left:-150px;
  animation: busDrive 12s linear infinite;
}

@keyframes busDrive{
  0%   { transform:translateX(-150px) }
  40%  { transform:translateX(40vw) }
  70%  { transform:translateX(75vw) }
  100% { transform:translateX(115vw) }
}

/* SHADOW */
.bus-shadow{
  width:80px;height:14px;background:rgba(0,0,0,0.25);
  border-radius:50%;filter:blur(5px);
  position:absolute;bottom:12px;left:-150px;
  animation: shadowDrive 12s linear infinite;
}

@keyframes shadowDrive{
  0%{ transform:translateX(-150px) scale(1) }
  50%{ transform:translateX(50vw) scale(1.2) }
  100%{ transform:translateX(115vw) scale(1) }
}

/* ======================================================
   MAIN UI
====================================================== */
body{background:var(--bg);display:flex;justify-content:center}
.wrap{ width:100%; max-width:720px; }

.header{text-align:center;margin-bottom:12px}
.brand{font-size:1.6rem;font-weight:800;color:var(--blue)}
.welcome{font-size:1.1rem;font-weight:600;margin-top:6px}
.sub{color:var(--muted);margin-top:4px}

.card{
  background:var(--card);padding:22px;
  border-radius:14px;border:1px solid var(--border);
  box-shadow:0 8px 20px rgba(0,0,0,0.06);
}

.input{width:100%;padding:14px;border-radius:10px;border:1px solid var(--border)}
.btn{
  width:100%;padding:14px;margin-top:10px;
  border:none;border-radius:10px;
  background:linear-gradient(var(--blue2),var(--blue));
  color:white;font-weight:700;cursor:pointer;
}

#box{margin-top:16px;padding:18px;border:1px solid var(--border);
  border-radius:12px;background:white;display:none}

/* SEAT ICON */
.right{display:flex;gap:12px;flex-wrap:wrap;justify-content:center}
.seat{
  width:92px;height:92px;border-radius:50%;
  background:linear-gradient(#e7f3ff,#b6d8ff);
  border:1px solid #c7dff4;
  display:flex;flex-direction:column;justify-content:center;align-items:center;
  font-weight:900;font-size:1.3rem;
  animation: seatPop 0.7s ease-out;
}
.seat span{font-size:28px}

@keyframes seatPop{
  0%{ transform:scale(0.2);opacity:0 }
  60%{ transform:scale(1.12);opacity:1 }
  85%{ transform:scale(0.95) }
  100%{ transform:scale(1) }
}

/* FEEDBACK */
#feedbackBox{
  margin-top:16px;padding:16px;border-radius:12px;
  background:#f7fbff;border:1px solid #dbeeff;text-align:center;display:none;
}

.fb-row{display:flex;gap:14px;justify-content:center;flex-wrap:wrap}
.fb-btn{
  padding:12px 18px;border-radius:12px;background:white;
  border:1px solid #cfe3ff;font-weight:700;cursor:pointer;
  transition:0.15s;
}
.fb-btn:hover{transform:translateY(-4px);box-shadow:0 8px 20px rgba(0,0,0,0.12)}
.fb-yes{color:#0b7a3d;border-color:#bfe8cf}
.fb-no{color:#b82828;border-color:#f2b7b7}

.footer{text-align:center;margin-top:16px;color:#8b9aad}
</style>
</head>

<body>

<div class="wrap">

  <!-- SKY WITH CLOUDS, SUN, MOON, STARS, SHOOTING STAR -->
  <div class="sky-container">
    <div class="sun"></div>
    <div class="moon"></div>
    <div class="cloud c1"></div>
    <div class="cloud c2"></div>
    <div class="cloud c3"></div>
    <div class="stars"></div>
    <div class="shooting-star"></div>
  </div>

  <!-- ROAD + BUS -->
  <div class="road-container">
    <div class="road"></div>
    <div class="bus-shadow"></div>
    <div class="bus-anim">ðŸšŒ</div>
  </div>

  <!-- HEADER -->
  <div class="header">
    <div class="brand">Welcome to Lagan Bus Booking</div>
    <div class="sub">For Reservations: <strong>0777 402 886 (Mr. Fawas)</strong></div>
  </div>

  <!-- MAIN CARD -->
  <div class="card">
    <input id="phone" class="input" placeholder="Enter phone number (0777...)">
    <button class="btn" id="searchBtn">Check My Booking</button>

    <div id="box">
      <div id="bname" style="font-size:1.4rem;font-weight:800;color:#204264"></div>
      <div id="dtime" style="margin-top:6px"></div>
      <div id="pickup" style="margin-top:8px"></div>
      <div id="pay" style="margin-top:8px"></div>
      <div class="right" id="seatsBox"></div>

      <div id="feedbackBox">
        <div style="font-weight:700;margin-bottom:10px;">Did you get your seat number correctly?</div>
        <div class="fb-row">
          <button class="fb-btn fb-yes" onclick="sendFeedback('Yes')">ðŸ˜Š Yes</button>
          <button class="fb-btn fb-no" onclick="sendFeedback('No')">ðŸ˜• No</button>
        </div>
      </div>
    </div>

    <div class="footer">Made by <strong>WEDOXA</strong></div>
  </div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwKWNQcXnjjzh540oJWgZJsJi1wQMd0PS94pjiHXy7VjlrR95ME2xnveTuDhPvlZScdow/exec";

document.getElementById('searchBtn').onclick = search;

function search(){
  const phone = document.getElementById('phone').value.trim();
  if(!phone){ Swal.fire("Enter phone number"); return; }

  Swal.fire({title:"Checking...", didOpen:()=>Swal.showLoading()});

  fetch(`${SCRIPT_URL}?phone=${phone}`)
    .then(r=>r.json())
    .then(j=>{
      Swal.close();
      if(!j.success){ Swal.fire("No booking found"); return; }
      show(j.booking);
    });
}

function show(b){
  document.getElementById('box').style.display="block";
  document.getElementById('feedbackBox').style.display="block";

  let date = b.Date || "";
  if(date.includes("T")) date = date.split("T")[0];

  document.getElementById('bname').innerText = b.Bus || "-";
  document.getElementById('dtime').innerText = `${date} â€¢ ${b.Time || "-"}`;
  document.getElementById('pickup').innerText = "Pickup â€” " + (b.Pickup || "-");
  document.getElementById('pay').innerText = "Payment â€” " + (b.Payment || "-");

  const box = document.getElementById('seatsBox');
  box.innerHTML="";

  const seats = String(b.Seat || "").split(/[, ]+/).filter(Boolean);
  if(seats.length===0){ addSeat("-"); }
  else seats.forEach((s)=> addSeat(s));
}

function addSeat(n){
  const el = document.createElement("div");
  el.className = "seat";
  el.innerHTML = `<span>ðŸ’º</span>${n}`;
  document.getElementById('seatsBox').appendChild(el);
}

function sendFeedback(ans){
  const phone = document.getElementById('phone').value.trim();

  fetch(`${SCRIPT_URL}?action=feedback&phone=${phone}&answer=${ans}`)
    .then(r=>r.json())
    .then(j=>{
      if(j.success){
        Swal.fire("Thank you!");
        document.getElementById('feedbackBox').style.display="none";
      }
    });
}
</script>
</body>
</html>
